apiVersion: skaffold/v4beta7
kind: Config
metadata:
  name: toolrent-microservices

build:
  artifacts:
    - image: mharko/eureka-server
      context: Backend/Infrastructure/eureka-service
      jib: {}

    - image: mharko/config-server
      context: Backend/Infrastructure/config-service
      jib: {}

    - image: mharko/gateway-server
      context: Backend/Infrastructure/gateway-service
      jib: {}

    - image: mharko/amounts-service
      context: Backend/Microservices/amounts
      jib: {}

    - image: mharko/clients-service
      context: Backend/Microservices/clients
      jib: {}

    - image: mharko/inventory-service
      context: Backend/Microservices/inventory
      jib: {}

    - image: mharko/kardex-service
      context: Backend/Microservices/kardex
      jib: {}

    - image: mharko/loans-service
      context: Backend/Microservices/loans
      jib: {}

    - image: mharko/reports-service
      context: Backend/Microservices/reports
      jib: {}

    - image: mharko/users-service
      context: Backend/Microservices/users
      jib: {}

manifests:
  rawYaml:
    - Backend/Kubernetes-Config/Global/*.yaml
    - Backend/Kubernetes-Config/DB/*.yaml
    - Backend/Kubernetes-Config/Infrastructure/*.yaml
    - Backend/Kubernetes-Config/Microservices/*.yaml

deploy:
  kubectl: {}

portForward:
  - resourceType: service
    resourceName: gateway-server
    port: 8080
    localPort: 8080
  
  - resourceType: service
    resourceName: eureka-server
    port: 8761
    localPort: 8761
    
  - resourceType: service
    resourceName: keycloak-service
    port: 9090
    localPort: 31000